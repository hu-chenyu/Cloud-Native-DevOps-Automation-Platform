# äº‘åŸç”ŸDevOpsè‡ªåŠ¨åŒ–å¹³å°

## ğŸš€ ç¬¬äºŒé˜¶æ®µæ ¸å¿ƒæˆæœï¼ˆAnsible Roleå¼€å‘ï¼‰

### ğŸ› ï¸ æŠ€æœ¯ç‰¹æ€§
| ç»„ä»¶     | åŠŸèƒ½å®ç°                                     | æŠ€æœ¯æŒ‡æ ‡                           |
|----------|----------------------------------------------|------------------------------------|
|**Docker**| å¯†é’¥ç®¡ç†/é•œåƒåŠ é€Ÿ/æ—¥å¿—è½®è½¬/å¥åº·æ£€æŸ¥          | 23é¡¹ä»»åŠ¡å…¨ç»¿ï¼ˆ0å¤±è´¥ï¼‰              |
| **Nginx**| åŠ¨æ€é…ç½®/æœåŠ¡è‡ªå¯/SSLé›†æˆ/æ™ºèƒ½è‡ªæ„ˆ           | 8é¡¹ä»»åŠ¡å…¨ç»¿ï¼ˆ0å¤±è´¥ï¼‰               |

### ğŸ“Š æ‰§è¡ŒéªŒè¯
```bash
# Dockeréƒ¨ç½²éªŒè¯ï¼ˆè€—æ—¶: 2m18sï¼‰
$ ansible-playbook playbooks/deploy_docker.yml
PLAY RECAP
47.98.112.245 : ok=23 changed=0 ...

# Nginxéƒ¨ç½²éªŒè¯ï¼ˆè€—æ—¶: 47sï¼‰  
$ ansible-playbook playbooks/deploy_nginx.yml
PLAY RECAP
47.98.112.245 : ok=8 changed=0 ...
```

### ğŸ“‚ é¡¹ç›®ç»“æ„
```bash
â”œâ”€â”€ ansible.cfg                   # Ansibleä¸»é…ç½®æ–‡ä»¶
â”œâ”€â”€ ansible_debug.log             # è°ƒè¯•æ—¥å¿—
â”œâ”€â”€ container_app/                # ç¤ºä¾‹å®¹å™¨åº”ç”¨ä»£ç 
â”‚   â”œâ”€â”€ app.py                    # åº”ç”¨å…¥å£
â”‚   â””â”€â”€ src/
â”‚       â””â”€â”€ main.py               # æ ¸å¿ƒä¸šåŠ¡é€»è¾‘
â”œâ”€â”€ Dockerfile                    # åº”ç”¨å®¹å™¨åŒ–æ„å»ºæ–‡ä»¶
â”œâ”€â”€ inventory/                    # ä¸»æœºæ¸…å•é…ç½®
â”‚   â””â”€â”€ manual_ecs.ini            # ECSä¸»æœºæ¸…å•æ¨¡æ¿
â”œâ”€â”€ nginx_conf/                   # Nginxé™æ€é…ç½®å¤‡ä»½
â”‚   â”œâ”€â”€ app.conf                  # åº”ç”¨æ¨¡æ¿é…ç½®
â”‚   â””â”€â”€ huchenyu.conf             # å®šåˆ¶åŒ–é…ç½®ç¤ºä¾‹
â”œâ”€â”€ playbooks/                    # éƒ¨ç½²å‰§æœ¬ä¸­å¿ƒ
â”‚   â”œâ”€â”€ deploy_docker.yml         # Dockeré›†ç¾¤éƒ¨ç½²å‰§æœ¬
â”‚   â”œâ”€â”€ deploy_nginx.yml          # NginxæœåŠ¡éƒ¨ç½²å‰§æœ¬
â”‚   â””â”€â”€ files/                    # å…±äº«è„šæœ¬æ–‡ä»¶
â”‚       â””â”€â”€ health_check.sh       # OpenRestyå¥åº·æ£€æŸ¥è„šæœ¬
â”œâ”€â”€ README.md                     # é¡¹ç›®æ–‡æ¡£
â””â”€â”€ roles/                        # Ansibleè§’è‰²è§„èŒƒ
    â”œâ”€â”€ docker/                   # å®¹å™¨ç®¡æ§è§’è‰²
    â”‚   â”œâ”€â”€ files/                # é™æ€æ–‡ä»¶å­˜å‚¨
    â”‚   â”œâ”€â”€ handlers/             # æœåŠ¡æ§åˆ¶å¤„ç†å™¨
    â”‚   â”‚   â””â”€â”€ main.yml          # å®šä¹‰Dockeré‡è½½/é‡å¯åŠ¨ä½œ
    â”‚   â”œâ”€â”€ tasks/                # æ¨¡å—åŒ–ä»»åŠ¡åˆ†è§£
    â”‚   â”‚   â””â”€â”€ main.yml          # ä¸»éƒ¨ç½²æµç¨‹
    â”‚   â””â”€â”€ templates/            # é…ç½®æ¨¡æ¿
    â”‚       â””â”€â”€ docker-daemon.json.j2  # daemon.jsonæ¨¡æ¿æ–‡ä»¶
    â””â”€â”€ nginx/                    # WebæœåŠ¡è§’è‰²
        â”œâ”€â”€ defaults/             # é»˜è®¤å˜é‡
        â”‚   â””â”€â”€ main.yml          # ç«¯å£/è·¯å¾„ç­‰é»˜è®¤é…ç½®
        â”œâ”€â”€ files/                # é™æ€èµ„æº
        â”‚   â”œâ”€â”€ health_check.sh   # å¢å¼ºç‰ˆå¥åº·æ£€æŸ¥è„šæœ¬
        â”‚   â”œâ”€â”€ index.html        # é»˜è®¤é¦–é¡µæ–‡ä»¶
        â”‚   â””â”€â”€ ssl/              # SSLè¯ä¹¦ç®¡ç†
        â”‚       â”œâ”€â”€ server.crt    # æµ‹è¯•è¯ä¹¦
        â”‚       â””â”€â”€ server.key    # æµ‹è¯•ç§é’¥
        â”œâ”€â”€ handlers/             # æœåŠ¡æ§åˆ¶
        â”‚   â””â”€â”€ main.yml          # å¹³æ»‘é‡è½½å¤„ç†å™¨
        â”œâ”€â”€ meta/                 # è§’è‰²å…ƒæ•°æ®
        â”‚   â””â”€â”€ main.yml          # å£°æ˜ä¾èµ–å…³ç³»
        â”œâ”€â”€ tasks/                # éƒ¨ç½²ä»»åŠ¡é“¾
        â”‚   â””â”€â”€ main.yml          # å®‰è£…â†’é…ç½®â†’éƒ¨ç½²æµç¨‹
        â”œâ”€â”€ templates/            # åŠ¨æ€é…ç½®æ¨¡æ¿
        â”‚   â””â”€â”€ nginx.conf.j2     # æ¨¡æ¿åŒ–é…ç½®
        â””â”€â”€ vars/                 # ä¸“æœ‰å˜é‡
            â””â”€â”€ main.yml          # ç”Ÿäº§ç¯å¢ƒä¸“ç”¨å˜é‡
